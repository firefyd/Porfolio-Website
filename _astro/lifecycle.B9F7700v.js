import{N as d,W as k,a0 as h,X as y,D as u,O as _,h as l,c as A,aC as E,P as T,E as w,a as D,as as F,G as x,I as M,J as N,s as R,K as p,o as S,aD as C,u as v,aE as b,q as G,aF as I,A as g,aG as O,a7 as P}from"./template.BunaqPUe.js";class q{anchor;#s=new Map;#t=new Map;#e=new Map;#a=new Set;#r=!0;constructor(e,s=!0){this.anchor=e,this.#r=s}#i=()=>{var e=d;if(this.#s.has(e)){var s=this.#s.get(e),t=this.#t.get(s);if(t)k(t),this.#a.delete(s);else{var i=this.#e.get(s);i&&(this.#t.set(s,i.effect),this.#e.delete(s),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),t=i.effect)}for(const[a,r]of this.#s){if(this.#s.delete(a),a===e)break;const f=this.#e.get(r);f&&(h(f.effect),this.#e.delete(r))}for(const[a,r]of this.#t){if(a===s||this.#a.has(a))continue;const f=()=>{if(Array.from(this.#s.values()).includes(a)){var c=document.createDocumentFragment();E(r,c),c.append(u()),this.#e.set(a,{effect:r,fragment:c})}else h(r);this.#a.delete(a),this.#t.delete(a)};this.#r||!t?(this.#a.add(a),y(r,f,!1)):f()}}};#f=e=>{this.#s.delete(e);const s=Array.from(this.#s.values());for(const[t,i]of this.#e)s.includes(t)||(h(i.effect),this.#e.delete(t))};ensure(e,s){var t=d,i=T();if(s&&!this.#t.has(e)&&!this.#e.has(e))if(i){var a=document.createDocumentFragment(),r=u();a.append(r),this.#e.set(e,{effect:_(()=>s(r)),fragment:a})}else this.#t.set(e,_(()=>s(this.anchor)));if(this.#s.set(t,e),i){for(const[f,n]of this.#t)f===e?t.skipped_effects.delete(n):t.skipped_effects.add(n);for(const[f,n]of this.#e)f===e?t.skipped_effects.delete(n.effect):t.skipped_effects.add(n.effect);t.oncommit(this.#i),t.ondiscard(this.#f)}else l&&(this.anchor=A),this.#i()}}function H(o,e,s=!1){l&&D();var t=new q(o),i=s?F:0;function a(r,f){if(l){const c=x(o)===M;if(r===c){var n=N();R(n),t.anchor=n,p(!1),t.ensure(r,f),p(!0);return}}t.ensure(r,f)}w(()=>{var r=!1;e((f,n=!0)=>{r=!0,a(n,f)}),r||a(!1,null)},i)}function J(o=!1){const e=S,s=e.l.u;if(!s)return;let t=()=>O(e.s);if(o){let i=0,a={};const r=P(()=>{let f=!1;const n=e.s;for(const c in n)n[c]!==a[c]&&(a[c]=n[c],f=!0);return f&&i++,i});t=()=>g(r)}s.b.length&&C(()=>{m(e,t),b(s.b)}),v(()=>{const i=G(()=>s.m.map(I));return()=>{for(const a of i)typeof a=="function"&&a()}}),s.a.length&&v(()=>{m(e,t),b(s.a)})}function m(o,e){if(o.l.s)for(const s of o.l.s)g(s);e()}export{H as a,J as i};
